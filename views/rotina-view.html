<div class="content-wrapper">
	<section class="content-header">
		<h1>
			Rotina <small>{$rotina}</small>
		</h1>
	</section>

	<section class="content">
		<div class="row">
			<div class="col-xs-12">
				<div class="box box-primary">
					<div class="box-header with-border">
						<h3 class="box-title">Informação da rotina</h3>
						<!-- <div class="pull-right">
								<a href="/modulo/{}/add/rotina"><i class="fa fa-edit"></i>
									<span>&nbsp;Editar</span></a>
							</div> -->
					</div>
					<div class="box-body">
						<div class="box-body table-responsive no-padding">
							<table class="table table-hover">
								<tr>
									<th>Rotina</th>
									<th>Nome</th>
									<th>Ações</th>
								</tr>
								<tr>
									<td>{$rotina}</td>
									<td>{$nome}</td>
									<td style="width: 150px">
										<a class="btn label-primary"><i class="fa fa-edit"></i><span> Editar</span></a>
										&nbsp;
									</td>
								</tr>
							</table>
						</div>

					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="box box-primary">
					<div class="box-header with-border">
						<h3 class="box-title">Tabelas de<br> Précondição</h3>
						<div class="pull-right">
							<a href="/rotina/{$rotina}/add/tabela"><i class="fa fa-plus"></i>
								<span>&nbsp;Adicionar Tabela</span></a>
						</div>
					</div>
					<div class="box-body">
						<div class="box-body table-responsive no-padding">
							<table class="table table-hover">
								<tr>
									<th>Tabelas</th>
									<th style="width: 150px">Ações</th>
								</tr>
								{loop="$precondicao"}
								{loop="$value"}
								<tr>
									<td><a href="/tabela/{$key}">{$key}</a></td>
									<td>
										<button class="btn btn-danger"
											onclick="deletar('/rotina/{$rotina}/delete/tabela/pre/{$key}')"><i
												class="fa fa-close"></i><span>
												Excluir</span></button>
										&nbsp;
									</td>
								</tr>
								{/loop}
								{/loop}
							</table>
						</div>

					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="box box-primary">
					<div class="box-header with-border">
						<h3 class="box-title">Tabelas de<br> Resultado Esperado</h3>
						<div class="pull-right">
							<a href="/rotina/{$rotina}/add/tabela"><i class="fa fa-plus"></i>
								<span>&nbsp;Adicionar Tabela</span></a>
						</div>
					</div>
					<div class="box-body">
						<div class="box-body table-responsive no-padding">
							<table class="table table-hover">
								<tr>
									<th>Tabelas</th>
									<th style="width: 150px">Ações</th>
								</tr>
								{loop="$resultado"}
								{loop="$value"}
								<tr>
									<td><a href="/tabela/{$key}">{$key}</a></td>
									<td>
										<button class="btn btn-danger"
											onclick="deletar('/rotina/{$rotina}/delete/tabela/res/{$key}')"><i
												class="fa fa-close"></i><span>
												Excluir</span></button>
										&nbsp;
									</td>
								</tr>
								{/loop}
								{/loop}
							</table>
						</div>

					</div>
				</div>
			</div>


			<div class="col-md-4">
				<div class="box box-primary">
					<div class="box-header with-border">
						<h3 class="box-title">Parâmetros<br> &nbsp;</h3>
						<div class="pull-right">
							<a href="/rotina/{$rotina}/add/parametro"><i class="fa fa-plus"></i>
								<span>&nbsp;Adicionar Parâmetro</span></a>
						</div>
						<br>
						<div class="pull-right">
							<a style="cursor: pointer" onclick="parametrosRotina()"><i class="fa fa-plus"></i>
								<span>&nbsp;Adicionar todos os parâmetros da rotina</span></a>
						</div>
					</div>
					<div class="box-body">
						<div class="box-body table-responsive no-padding">
							<table class="table table-hover">
								<tr>
									<th>Parâmetros</th>
									<th style="width: 150px">Ações</th>
								</tr>
								{loop="$parametros"}
								<tr>
									<td><a href="/parametro/{$value}">{$value}</a></td>
									<td>
										<button class="btn btn-danger" onclick=""><i class="fa fa-close"></i><span>
												Excluir</span></button>
										&nbsp;
									</td>
								</tr>
								{/loop}
							</table>
						</div>

					</div>
				</div>
			</div>


		</div>
	</section>
</div>

<script>
	function parametrosRotina() {
		swal({
				text: 'Digite o diretório da rotina:',
				content: "input",
				button: {
					text: "Procurar!",
					closeModal: false,
				},
			})
			.then(name => {
				if (!name) throw null;

				// return fetch(`https://itunes.apple.com/search?term=${name}&entity=movie`);
				return fetch(`http://localhost:12001/rotina/parametros/${name}`);
			})
			.then(results => {
				return results.json();
			})
			.then(json => {
				const movie = json.results[0];

				if (!movie) {
					return swal("No movie was found!");
				}

				const name = movie.trackName;
				const imageURL = movie.artworkUrl100;

				swal({
					title: "Top result:",
					text: name,
					icon: imageURL,
				});
			})
			.catch(err => {
				if (err) {
					swal("Oh noes!", "The AJAX request failed!", "error");
				} else {
					swal.stopLoading();
					swal.close();
				}
			});
	}
</script>